<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>A Practical Guide to Applied Machine Learning</title>

  <meta name="description" content="Using python and scikit-learn, we'll walk through a machine learning process from start to finish discussing when to apply machine learning, the most successful algorithms, best practices, and even a little philosophy.">
  <meta name="author" content="Jeremy Gore">

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

  <link rel="stylesheet" href="../reveal.js/css/reveal.css">
  <link rel="stylesheet" href="../css/tessella.css" id="theme">
  <link rel="stylesheet" href="../css/presentation.css">

  <!-- Code syntax highlighting -->
  <link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>

<!--[if lt IE 9]>
<script src="lib/js/html5shiv.js"></script>
<![endif]-->
</head>

<body>
<div class="reveal">
<div class="slides">

<section>
  <section id="title" class="container">
    <div class="col-md-4 nopadding">
      <svg width="300" height="600"></svg>
    </div>
    <div class="col-md-8 text-right">
      <img class="noborder" style="width:300px;height:auto; margin-bottom:1em; " src='../img/Tessella_Logo.png'>
      <h2 class="text-right">A Practical Guide to Applied Machine Learning</h2>
      <h2 class="text-right"><small>Jeremy Gore<br>Autumn Conference 2015-10-05</small></h2>
    </div>

    <aside class="notes">
      <p>To say machine learning is a big subject is a big understatement,
        but it may be easier than you think.</p>
      <p>Using python and scikit-learn, we'll walk through a machine learning
        process from start to finish discussing when to apply machine learning,
        the most successful algorithms, best practices, and even a little
        philosophy.</p>
    </aside>
  </section>

  <section id="instructions" data-background="#996699" data-background-transition="zoom">
    <h3>Presentation instructions</h3>
    <ul>
      <li>Press <kbd>ESC</kbd> to enter the slide overview</li>
      <li>Press <kbd>F</kbd> to display the speaker view with notes</li>
      <li>Press <kbd>B</kbd> or <kbd>.</kbd> to pause the presentation</li>
      <li>Press <kbd>S</kbd> to display the speaker view with notes</li>
      <li><kbd>Alt+click</kbd> on any element to zoom in on it, <kbd>Alt+click</kbd> anywhere to zoom back out</li>
      <li><kbd>Swipe</kbd> to move on mobile devices</li>
    </ul>
  </section>

  <section id="topics" class="container">
    <h2>Topics</h2>
    <div class="row row-eq-height">
      <div class="col-md-6">
        <div class="panel panel-green">
          <div class="panel-heading">
            <h4>Will Cover</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">General Techniques</li>
            <li class="list-group-item">Supervised learning</li>
            <li class="list-group-item">Tabular data</li>
          </ul>
        </div>
      </div>
      <div class="col-md-6">
        <div class="panel panel-red">
          <div class="panel-heading">
            <h4>Won't Cover</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Other learning</li>
            <li class="list-group-item">Structured models</li>
            <li class="list-group-item">Sequential models</li>
          </ul>
        </div>
      </div>
    </div>

    <aside class="notes">

    </aside>
  </section>

</section>

<section>
  <section id="what-is-ml">
    <h1>What is machine learning?</h1>
    <img src="../img/ml.gif">
  </section>

  <section id="concepts" class="container">
    <h2>Core Concepts</h2>
    <div class="row row-eq-height">
      <div class="col-md-6">
        <div class="panel panel-orange">
          <div class="panel-heading">
            <h4>Data</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Items</li>
            <li class="list-group-item">Features</li>
            <li class="list-group-item">Labels</li>
            <li class="list-group-item">Classes</li>
          </ul>
        </div>
      </div>
      <div class="col-md-6">
        <div class="panel panel-purple">
          <div class="panel-heading">
            <h4>Models</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Algorithms</li>
            <li class="list-group-item">Parameters</li>
            <li class="list-group-item">Hyper-parameters</li>
          </ul>
        </div>
      </div>
    </div>

    <aside class="notes" data-markdown>
      Like any discipline machine learning has some key concepts which you need to be familiar with.  We will explain these terms in more detail in the rest of the presentation.  Here's the basics:

      Machine learning works with **Data**, which is made up of individual **Items** or equivalently **Records**, **Points**, or **Samples**. **Features** are the various numerical and categorical traits which describe the item, and **Labels** are what you are attempting to predict based on the features.  **Classes** are the discrete possible values which labels may take in classification problems.

      **Models** are the tools you use to explain your samples.  In machine learning, models are built on, and generated by, **Algorithms**.  ML models can have radically different designs but all are intended to learn complex representations of arbitrary data.  The tunable parts of a model are called **Parameters**, and there are also **Hyperparameters** which control how the model is constructed and trained.
    </aside>
  </section>

  <section id="ml-flavors" class="container">
    <h2>Flavors of Machine Learning</h2>
    <div class="row row-eq-height">
      <div class="col-md-4">
        <div class="panel panel-red">
          <div class="panel-heading">
            <h4>Supervised</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Classification</li>
            <li class="list-group-item">Regression</li>
            <li class="list-group-item">Ranking</li>
          </ul>
        </div>
      </div>
      <div class="col-md-4">
        <div class="panel panel-blue">
          <div class="panel-heading">
            <h4>Unsupervised</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Clustering</li>
            <li class="list-group-item">Density estimation</li>
            <li class="list-group-item">Pattern identification</li>
            <li class="list-group-item">Representation learning</li>
          </ul>
        </div>
      </div>
      <div class="col-md-4">
        <div class="panel panel-green">
          <div class="panel-heading">
            <h4>Hybrid</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Semi-supervised</li>
            <li class="list-group-item">Reinforcement learning</li>
          </ul>
        </div>
      </div>
    </div>

    <aside class="notes" data-markdown>
      There are four major types of machine learning problems:

      - Supervised: make predictions
        - Classification: predict from a sample of labels
        - Regression: predict a numeric value
        - Ranking: predict an order for data
      - Unsupervised: identify structure
        - Clustering: find groups within your data
        - Density estimation: identify distribution of samples in the feature domain
        - Pattern identification: identify common patterns
        - Representation learning: describe the data with much less information
      - Semi-supervised: supervised learning with additional unlabeled data to help characterize the feature domain
      - Reinforcement learning: data is generated by interaction with environment, attempting to maximize a reward
    </aside>
  </section>

  <section id="data-models">
    <h2>Data and models</h2>
    <ul>
      <li>Tabular data</li>
      <li>Structured data</li>
      <li>Graphical models</li>
      <li>Sequential or process models</li>
    </ul>

    <aside class="notes" data-markdown>
      The most common form of machine learning problem is to make a prediction for independent samples, where the features of the sample are not really related to each other.  But this is not always the case.  There are many others that require special formulation and considerations, such as:

      - [Structured data](NeuralNetworks.md#convolutional-layers): When there is a structural relationship between the features (such as pixels in an image)
      - [Graphical models](Probabilistic.md#graphical-techniques): Given samples for a collection of nodes, construct a network between the nodes
      - [Sequential or process models](NeuralNetworks.md#recurrent-neural-networks): When the input and/or output is a sequence of arbitrary length
    </aside>
  </section>

</section>

<section>
  <section id="process">
    <h1>The process of machine learning</h1>
  </section>

  <section id="steps">
    <h2>Steps of a machine learning problem</h2>
    <ol>
      <li class="fragment">Know your problem</li>
      <li class="fragment">Know your data</li>
      <li class="fragment">Set up your test harness</li>
      <li class="fragment">Spot check a variety of algorithms</li>
      <li class="fragment">Fine tune the best ones</li>
    </ol>

    <aside class="notes" data-markdown>
      The most fundamental question for machine learning (or indeed most projects) is what problem are you trying to solve? Can machine learning help you with this?  What kind of machine learning question is it?

      - What problem are you trying to solve?
      - Is machine learning a good fit for this problem?
      - Is this a supervised or unsupervised question?
      - Should you use an existing simple model instead?
    </aside>
  </section>

  <section id="data">
    <h2>Know your data</h2>
    <ul>
      <li class="fragment">Where is it?</li>
      <li class="fragment">What form is it in?</li>
      <li class="fragment">What does it look like?</li>
      <li class="fragment">Is it any good?</li>
    </ul>

    <aside class="notes" data-markdown>
      You must also understand your data and how to use it.

      - Where is your data coming from?
        - How will you obtain it?
        - Do you have sufficient privileges?
        - Are you legally allowed to use your data to solve your problem? Be especially cautious about patient data.
      - What form is your data in?
        - How will you wrangle it into a form that can be analyzed?
        - Do you need to wrangle your data only once or more often?
        - What are the types of your features?
        - Will any of them need to be transformed into a different form for processing?
      - What does your data look like?
        - Can you plot it and if so, is their a pattern?
      - What data do you have to work with?
        - Do I have enough examples to train with?
        - Do you have many more samples than features? If not training may not be effective.
        - Do you have a lot of irrelevant features? These can introduce spurious correlations.
        - Are there any other features that you think might be useful and can you get them?
        - Is it labeled, and if so how?
        - Are your labels balanced?
        - Are any of your features exponential in nature? You may want to log transform them.
        - Are any of the features in your data identifiers? You may want to discard these: they can be used to overfit, and should not be interpreted as numbers.
    </aside>
  </section>

  <section id="wrangling">
    <h2>Data Wrangling/Munging</h2>
    <img src="../img/wrangling.gif">
  </section>

</section>

<section>
  <section id="environment">
    <h1>Environment</h1>
  </section>

  <section id="hardware-software" class="container">
    <h2>Hardware and Software</h2>
    <div class="row row-eq-height">
      <div class="col-md-6">
        <div class="panel panel-orange">
          <div class="panel-heading">
            <h4>Machine</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item">Plenty of memory (8GB)</li>
            <li class="list-group-item">NVidia GPU, or decent CPU</li>
            <li class="list-group-item">Preferably Linux</li>
            <li class="list-group-item">Local or Server?</li>
          </ul>
        </div>
      </div>
      <div class="col-md-6">
        <div class="panel panel-purple">
          <div class="panel-heading">
            <h4>ML Platform</h4>
          </div>
          <ul class="list-group">
            <li class="list-group-item"><a href="https://www.r-project.org/">R</a></strong>: Premier statistical platform</li>
            <li class="list-group-item"><a href="https://www.python.org/">Python</a></strong>: Production ready, highly flexible</li>
            <li class="list-group-item"><em><a href="http://www.mathworks.com/products/matlab/">MatLab</a></em>: Proprietary numerical platform</li>
            <li class="list-group-item"><em><a href="http://julialang.org/">Julia</a></em>: New hotness</li>
          </ul>
        </div>
      </div>
    </div>

    <aside class="notes" data-markdown>
      Like any heavy computing task, in machine learning you must consider hardware and software.

      When choosing the system to perform machine learning (if you have a choice) you should take the following aspects into account:

      1. Plenty of memory, because both datasets and algorithms can require a lot of memory
      2. NVidia GPU, which can give you massive performance improvements for neural networks, often 30x.  It can make a huge difference in your ability to investigate.  Failing that, you want the best CPU you have.
      3. Most tools, libraries, and dependencies are available for Linux, OS X, and Windows.  But you will find that actually installing those on systems other than Linux can be quite painful, even on another Unix like OS X.  One time I had a compile fail because I didn't invoke the makefile from bash.  So if you can, save yourself some grief and use Linux.
      4. The first three requirements definitely favor a server, but there are plenty of benefits to being able to work without a connection.  If you can, do both, and keep things in sync with git, which you were already using RIGHT?

      Which brings us to your machine learning software platform.  Sure there are innumerable tools and services, but if you want to investigate properly you need a platform with a consistent interface which is kept up-to-date with the latest algorithms. At the moment, there are two primary ones and two secondary ones, all of which I have used at one time or another.

      [R](https://www.r-project.org/) is *the* premier open source statistical platform, and the most popular ML tool with the most algorithms.  It is widely used in academia, and so most new algorithms actually show up there first.

      [Python](https://www.python.org/) on the other hand is a general-purpose programming language.  Two packages are especially useful for machine Learning: [scikit-learn](http://scikit-learn.org) wraps many ML algorithms in a common API along with plenty of utilities, and  [Theano](http://deeplearning.net/software/theano) can be used to compile numerical algorithms to native code.  Significantly, python is production ready and excellent for data wrangling.  This is the environment I will be using today.

      [MatLab](http://www.mathworks.com/products/matlab/) is a numerical computing environment with extensive use in academic and research institutions. But it is also proprietary and expensive and doesn't see much use elsewhere.

      [Julia](http://julialang.org/) is a very new high-performance dynamic programming language. It is specifically designed for numerical and scientific computing but also aims to be an effective general purpose language.  The syntax is concise and the performance is actually quite good.  But it is very young and core APIs are still changing, so although its package ecosystem is growing rapidly I can't recommend it just yet.
    </aside>
  </section>

</section>

<section>
  <section id="algorithms">
    <h1>Algorithms</h1>
  </section>

  <section id="no-free-lunch">
    <h2>No Free Lunch Theorem</h2>
    <p>The <a class="cite" href="https://en.wikipedia.org/wiki/No_free_lunch_theorem">no free lunch theorem</a> implies that no one algorithm will be suitable for all problems and that any algorithm could be the right one.</p>
    <p><em class="fragment">But...</em><span class="fragment"> in practice only a handful of algorithms are really worth considering</span></p>

    <aside class="notes">
    </aside>
  </section>

  <section id="essential-algorithms">
    <h3>The algorithms that really matter</h3>
    <ul>
      <li>Random Forests</li>
      <li>Neural Networks</li>
    </ul>

    <h3>The algorithms that are worth trying anyway</h3>
    <ul>
      <li>Linear regression</li>
      <li>Neural Networks</li>
    </ul>
    <aside class="notes">
    </aside>
  </section>
</section>

<section>
  <section id="instance">
    <h1>Instance Algorithms</h1>
  </section>

  <section id="decision-tree" data-state="dt-animation">
    <h2>Decision Trees</h2>

    <div class="col-md-6 nopadding">
      <svg width="450" height="600"></svg>
    </div>
    <div class="col-md-6">
      <p>Here is a decision tree</p>
    </div>
    <aside class="notes">
      <p></p>
      <p></p>
    </aside>
  </section>

  <section id="random-forest">
    <h2>Random Forests</h2>

  </section>

  <section id="quick-model">
    <h2>If I only had one model</h2>

<pre><code class="lang-py" data-trim data-noescape style="font-size: 18px;">
from sklearn.ensemble import ExtraTreesClassifier

# Create and fit the model
clf = ExtraTreesClassifier(n_estimators:1024, <span class="fragment strike">class_weight:"subsample"</span>)
clf.fit(train_features, train_labels)

# Verify performance
print clf.score(cv_features, cv_labels)

## To make predictions
clf.predict(data)
</code></pre>

    <aside class="notes" data-markdown>
      In fact if I was really in a pinch and could train only one model, it would be an ExtraTreesClassifier, because it will almost certainly give me an accurate result on without needing to preprocess the data or fuss with the hyperparameters.

      I set the number of estimators to a high number, since that will give us more accuracy without significant risk of overfitting.

      I would usually set the class_weight mode to "subsample" to ensure that the model treats all classes as equally important, which helps prevent an overrepresented class from skewing the model.  If that isn't appropriate then don't use it.
    </aside>
  </section>

  <section id="bagging-effectiveness" data-background="#ffff00" data-background-transition="zoom">
    <h2>Do the math:</h2>
    <p>Bagging is <a class="cite" href="http://statistics.berkeley.edu/sites/default/files/tech-reports/421.pdf">most effective</a> on unstable algorithms that overfit easily.</p>
    <p>A decision tree given sufficient depth will perfectly fit any input.</p>
    <aside class="notes">
    </aside>
  </section>

  <section id="decision-jungle" data-background="#ffff00" data-background-transition="zoom">
    <div class="col-md-4 nopadding">
      <svg width="300" height="600" style="background:white"></svg>
    </div>
    <div class="col-md-8">
      <h2>Do the math:</h2>
      <p>Decision Jungles use Directed Acyclic Graphs (DAGs) instead of trees.  This allows for smaller models which generalize slightly better.  </p>
      <p>They were developed by Microsoft, whose XBox Kinect controller uses Random Forests to analyze what it's seeing.</p>
    </div>
    <aside class="notes">
      <p></p>
    </aside>
  </section>
</section>

<section>
  <section id="model-behavior">
    <h1>Model Behavior</h1>
  </section>

  <section id="bias-variance" class="container">
    <div class="row">
      <div class="col-md-4">
        <h2>Bias</h2>
      </div>
      <div class="col-md-4">
        <h2>Variance</h2>
      </div>
      <div class="col-md-4">
        <h2>Generalization</h2>
      </div>
    </div>

    <aside class="notes" data-markdown>
      There are three sources of error in models **Bias** is the tendency of an model to favor specific representations of the data.  The counterpart of bias is **Variance**, the tendency of an algorithm to find very different representations for small variations in the data.  During training, high bias leads to **Underfitting** because the algorithm is incapable of finding or building a model, while high variance leads to **Overfitting** because it effectively memorizes the training data. What we really want is a model which **Generalizes** the data and can accurately and reliably handle whatever we throw at it.

      Let's use a metaphor. If you were shooting at a target, your bias is how far from the bullseye your shots are centered, and your variance is how spread apart your shots are.  A good model would have a tight grouping right in the center.

      The most important point about the bias-variance tradeoff is this: it is impossible to overcome intrinsic bias in a model, but it *is* possible to overcome variance.  We will discuss some tricks for this, but the most straightforward approach is simply more training with more data on complex, low-bias models. One more reason why "big data" is a big deal.

      Which brings us to the third source of error: insufficient or unrepresentative training data.  Garbage in, garbage out.
    </aside>
  </section>
</section>

<section>
  <section id="end" class="container">
    <h2>Thank you!</h2>
    <br>

    <div class="row">
      <div class="col-md-12 text-left">
        <h4>Further reading</h4>
        <ul>
          <li><a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/jmgore75/PracticalML/master/presentation/conference2015.html">Replay</a> this presentation on <a href="https://github.com/jmgore75/PracticalML/">GitHub</a></li>
          <li><a href="http://machinelearningmastery.com/">Machine learning mastery</a> blog</li>
          <li><a href="https://www.udacity.com/course/machine-learning--ud262">Machine Learning</a> Udacity course series</li>
        </ul>
      </div>
    <div>
  </section>

  <section id="tools">
    <div class="row">
      <div class="col-md-6 text-left">
        <h4>Development Tools</h4>
        <ul>
          <li><a href="https://www.python.org/">Python</a> language</li>
          <li><a href="http://scikit-learn.org">scikit-learn</a> ML library</li>
        </ul>
      </div>
      <div class="col-md-6 text-left">
        <h4>Presentation Tools</h4>
        <ul>
          <li><a href="https://github.com/hakimel/reveal.js">Reveal.js</a> presentation framework</li>
          <li><a href="http://paletton.com/">Palleton</a> color pallete tool</li>
          <li><a href="http://d3js.org/">d3.js</a> charting library</li>
        </ul>
      </div>
    </div>

    <aside class="notes">

    </aside>
  </section>

</section>

</div>
</div>

<!-- Setup -->

<script src="../reveal.js/lib/js/head.min.js"></script>
<script src="../reveal.js/js/reveal.js"></script>

<script>
  // Full list of configuration options available at:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,

    transition: 'concave',

    // Optional reveal.js plugins
    dependencies: [
      { src: '../reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: '../reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: '../reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: '../reveal.js/plugin/highlight/highlight.js', async: true, condition: function() {
          return !!document.querySelector( 'pre code' );
        }, callback: function() {
          hljs.initHighlightingOnLoad();
        }
      },
      { src: '../reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: '../reveal.js/plugin/notes/notes.js', async: true }
    ]
  });
</script>

<script src="../js/d3.min.js"></script>
<script src="../js/dt.js"></script>
<script>
//Animations
(function () {
  var graphMap = {
    "title" : [new Tree(5, 3, 0.1), new DAG(7, 3, 8), new NN(4, 8, 8, 8, 3)],
    "decision-tree" : [new Tree(5, 3, 0.1), new Tree(4, 2, 0.1), new Tree(5, 3, 0.2)],
    "decision-jungle" : [new DAG(7, 3, 8), new DAG(8, 2, 6), new DAG(7, 3, 8)],
    "neural-network"  : [new NN(4, 8, 8, 8, 3)],
    "elm"             : [new NN(4, 16, 3)]
  }

  function loopGraphs(slide, graphs) {
    if (!slide) {
      return;
    }
    var graphs = Array.prototype.slice.call(arguments);
    var slide = graphs.shift();

    if (!graphs.length) {
      graphs = graphMap[slide.id] || [];
    }
    var svg = d3.select(slide).select("svg");

    if (svg[0][0] && graphs.length) {
      var t = svg.interrupt().transition();
      svg.selectAll("*").remove();

      function loop(t) {
        graphs.forEach(function (graph) {
          //Update each on a timer
          graph.steps.forEach(function (step) {
            t = t.transition().duration(step.duration || 0).each("start", function () {
              displayStep(step, svg);
            });
          });
          t = t.transition().duration(3000);
          t = t.transition().duration(clearStep.duration || 0).each("start", function () {
            displayStep(clearStep, svg);
          });
          t = t.transition().duration(500).each("start", function () {
            svg.selectAll("*").remove();
          });
        })

        t = t.each("end", function () {
          loop(t);
        });
      }

      loop(t);
    }
  }

  function showGraph(slide, graph) {
    if (!slide) {
      return;
    }
    if (!graph) {
      var graphs = graphMap[slide.id];
      if (graphs) {
        graph = graphs[0];
      }
    }
    var svg = d3.select(slide).select("svg");
    if (svg[0][0] && graph) {
      svg.interrupt().transition();
      svg.selectAll("*").remove();
      var step = graph.lastStep();
      if (step) {
        displayStep(step, svg, 0);
      }
    }
  }

  Reveal.addEventListener('ready', function (event) {
    for (var id in graphMap) {
      var slide = document.getElementById(id);
      if (slide) {
        showGraph(slide)
      }
    }
    loopGraphs(event.currentSlide);
  });

  var svg;

  Reveal.addEventListener( 'slidechanged', function(event) {
    showGraph(event.previousSlide);
    loopGraphs(event.currentSlide);
  } );

})();

</script>

</body>

</html>
